<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Introduction to Contexts and Dependency Injection</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!DOCTYPE html>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/patternfly/3.24.0/css/patternfly.min.css">
<link rel="stylesheet" type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/patternfly/3.24.0/css/patternfly-additions.min.css">
<link rel="stylesheet" type="text/css"
      href="stylesheet/config.css">
<link rel="stylesheet" type="text/css"
      href="stylesheet/asciidoc-tabs.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/patternfly/3.24.0/js/patternfly.min.js"></script>
<script src="javascript/config.js"></script>
<script src="javascript/asciidoc-tabs.js"></script>

<style>
    .book {
        font-size: 14px;
    }

    .admonitionblock td.content>.title, .audioblock>.title, .exampleblock>.title, .imageblock>.title,
    .listingblock>.title, .literalblock>.title, .stemblock>.title, .openblock>.title, .paragraph>.title,
    .quoteblock>.title, table.tableblock>.title, .verseblock>.title, .videoblock>.title, .dlist>.title,
    .olist>.title, .ulist>.title, .qlist>.title, .hdlist>.title {
        font-size: 1.6rem;
    }

    p, blockquote, dt, td.content, span.alt, .quoteblock blockquote, .quoteblock blockquote p {
        font-size: 1.6rem;
    }

    pre code {
        font-size: 1.5rem;
    }

    #preamble>.sectionbody>[class="paragraph"]:first-of-type p {
        font-size: 1.6rem;
    }

    #header, #content, #footer, #footnotes {
        max-width: 72em;
    }
</style>
</head>
<body class="article">
<div id="header">
<h1>Introduction to Contexts and Dependency Injection</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this guide we&#8217;re going to describe the basic principles of the Quarkus programming model that is based on the <a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html" target="_blank" rel="noopener">Contexts and Dependency Injection for Java 2.0</a> specification.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ok-lets-start-simple-what-is-a-bean"><a class="anchor" href="#ok-lets-start-simple-what-is-a-bean"></a>1. OK. Let&#8217;s start simple. What is a bean?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Well, a bean is a <em>container-managed</em> object that supports a set of basic services, such as injection of dependencies, lifecycle callbacks and interceptors.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="wait-a-minute-what-does-container-managed-mean"><a class="anchor" href="#wait-a-minute-what-does-container-managed-mean"></a>2. Wait a minute. What does "container-managed" mean?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Simply put, you don&#8217;t control the lifecycle of the object instance directly.
Instead, you can affect the lifecycle through declarative means, such as annotations, configuration, etc.
The container is the <em>environment</em> where your application runs.
It creates and destroys the instances of beans, associates the instances with a designated context, and injects them into other beans.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-it-good-for"><a class="anchor" href="#what-is-it-good-for"></a>3. What is it good for?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An application developer can focus on the business logic rather than finding out "where and how" to obtain a fully initialized component with all of its dependencies.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You&#8217;ve probably heard of the <em>inversion of control</em> (IoC) programming principle. Dependency injection is one of the implementation techniques of IoC.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-does-a-bean-look-like"><a class="anchor" href="#what-does-a-bean-look-like"></a>4. What does a bean look like?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are several kinds of beans.
The most common ones are class-based beans:</p>
</div>
<div class="listingblock">
<div class="title">Simple Bean Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import javax.inject.Inject;
import javax.enterprise.context.ApplicationScoped;
import org.eclipse.microprofile.metrics.annotation.Counted;

@ApplicationScoped <i class="conum" data-value="1"></i><b>(1)</b>
public class Translator {

    @Inject
    Dictionary dictionary; <i class="conum" data-value="2"></i><b>(2)</b>

    @Counted  <i class="conum" data-value="3"></i><b>(3)</b>
    String translate(String sentence) {
      // ...
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This is a scope annotation. It tells the container which context to associate the bean instance with. In this particular case, a <strong>single bean instance</strong> is created for the application and used by all other beans that inject <code>Translator</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This is a field injection point. It tells the container that <code>Translator</code> depends on the <code>Dictionary</code> bean. If there is no matching bean the build fails.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This is an interceptor binding annotation. In this case, the annotation comes from the MicroProfile Metrics. The relevant interceptor intercepts the invocation and updates the relevant metrics. We will talk about <a href="#interceptors">interceptors</a> later.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="typesafe_resolution"><a class="anchor" href="#typesafe_resolution"></a>5. Nice. How does the dependency resolution work? I see no names or identifiers.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>That&#8217;s a good question.
In CDI the process of matching a bean to an injection point is <strong>type-safe</strong>.
Each bean declares a set of bean types.
In our example above, the <code>Translator</code> bean has two bean types: <code>Translator</code> and <code>java.lang.Object</code>.
Subsequently, a bean is assignable to an injection point if the bean has a bean type that matches the <em>required type</em> and has all the <em>required qualifiers</em>.
We&#8217;ll talk about qualifiers later.
For now, it&#8217;s enough to know that the bean above is assignable to an injection point of type <code>Translator</code> and <code>java.lang.Object</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hm-wait-a-minute-what-happens-if-multiple-beans-declare-the-same-type"><a class="anchor" href="#hm-wait-a-minute-what-happens-if-multiple-beans-declare-the-same-type"></a>6. Hm, wait a minute. What happens if multiple beans declare the same type?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is a simple rule: <strong>exactly one bean must be assignable to an injection point, otherwise the build fails</strong>.
If none is assignable the build fails with <code>UnsatisfiedResolutionException</code>.
If multiple are assignable the build fails with <code>AmbiguousResolutionException</code>.
This is very useful because your application fails fast whenever the container is not able to find an unambiguous dependency for any injection point.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Your can use programmatic lookup via  <code>javax.enterprise.inject.Instance</code> to resolve ambiguities at runtime and even iterate over all beans implementing a given type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Translator {

    @Inject
    Instance&lt;Dictionary&gt; dictionaries; <i class="conum" data-value="1"></i><b>(1)</b>

    String translate(String sentence) {
      for (Dictionary dict : dictionaries) { <i class="conum" data-value="2"></i><b>(2)</b>
         // ...
      }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This injection point will not result in an ambiguous dependency even if there are multiple beans that implement the <code>Dictionary</code> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>javax.enterprise.inject.Instance</code> extends <code>Iterable</code>.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="can-i-use-setter-and-constructor-injection"><a class="anchor" href="#can-i-use-setter-and-constructor-injection"></a>7. Can I use setter and constructor injection?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Yes, you can.
In fact, in CDI the "setter injection" is superseded by more powerful <a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html#initializer_methods" target="_blank" rel="noopener">initializer methods</a>.
Initializers may accept multiple parameters and don&#8217;t have to follow the JavaBean naming conventions.</p>
</div>
<div class="listingblock">
<div class="title">Initialized and Constructor Injection Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class Translator {

    private final TranslatorHelper helper;

    Translator(TranslatorHelper helper) { <i class="conum" data-value="1"></i><b>(1)</b>
       this.helper = helper;
    }

    @Inject <i class="conum" data-value="2"></i><b>(2)</b>
    void setDeps(Dictionary dic, LocalizationService locService) { <i class="conum" data-value="3"></i><b>(3)</b>
      / ...
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This is a constructor injection.
In fact, this code would not work in regular CDI implementations where a bean with a normal scope must always declare a no-args constructor and the bean constructor must be annotated with <code>@Inject</code>.
However, in Quarkus we detect the absence of no-args constructor and "add" it directly in the bytecode.
It&#8217;s also not necessary to add <code>@Inject</code> if there is only one constructor present.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>An initializer method must be annotated with <code>@Inject</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>An initializer may accept multiple parameters - each one is an injection point.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="you-talked-about-some-qualifiers"><a class="anchor" href="#you-talked-about-some-qualifiers"></a>8. You talked about some qualifiers?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html#qualifiers" target="_blank" rel="noopener">Qualifiers</a> are annotations that help the container to distinguish beans that implement the same type.
As we already said a bean is assignable to an injection point if it has all the required qualifiers.
If you declare no qualifier at an injection point the <code>@Default</code> qualifier is assumed.</p>
</div>
<div class="paragraph">
<p>A qualifier type is a Java annotation defined as <code>@Retention(RUNTIME)</code> and annotated with the <code>@javax.inject.Qualifier</code> meta-annotation:</p>
</div>
<div class="listingblock">
<div class="title">Qualifier Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Qualifier
@Retention(RUNTIME)
@Target({METHOD, FIELD, PARAMETER, TYPE})
public @interface Superior {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The qualifiers of a bean are declared by annotating the bean class or producer method or field with the qualifier types:</p>
</div>
<div class="listingblock">
<div class="title">Bean With Custom Qualifier Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Superior <i class="conum" data-value="1"></i><b>(1)</b>
@ApplicationScoped
public class SuperiorTranslator extends Translator {

    String translate(String sentence) {
      // ...
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Superior</code> is a <a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html#defining_qualifier_types" target="_blank" rel="noopener">qualifier annotation</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This bean would be assignable to <code>@Inject @Superior Translator</code> and <code>@Inject @Superior SuperiorTranslator</code> but not to <code>@Inject Translator</code>.
The reason is that <code>@Inject Translator</code> is automatically transformed to <code>@Inject @Default Translator</code> during typesafe resolution.
And since our <code>SuperiorTranslator</code> does not declare <code>@Default</code> only the original <code>Translator</code> bean is assignable.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="looks-good-what-is-the-bean-scope"><a class="anchor" href="#looks-good-what-is-the-bean-scope"></a>9. Looks good. What is the bean scope?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The scope of a bean determines the lifecycle of its instances, i.e. when and where an instance should be created and destroyed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Every bean has exactly one scope.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-scopes-can-i-actually-use-in-my-quarkus-application"><a class="anchor" href="#what-scopes-can-i-actually-use-in-my-quarkus-application"></a>10. What scopes can I actually use in my Quarkus application?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use all the built-in scopes mentioned by the specification except for <code>javax.enterprise.context.ConversationScoped</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Annotation</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@javax.enterprise.context.ApplicationScoped</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A single bean instance is used for the application and shared among all injection points. The instance is created lazily, i.e. once a method is invoked upon the <a href="#client_proxies">client proxy</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@javax.inject.Singleton</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Just like <code>@ApplicationScoped</code> except that no client proxy is used. The instance is created when an injection point that resolves to a @Singleton bean is being injected.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@javax.enterprise.context.RequestScoped</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The bean instance is associated with the current <em>request</em> (usually an HTTP request).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@javax.enterprise.context.Dependent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a pseudo-scope. The instances are not shared and every injection point spawns a new instance of the dependent bean. The lifecycle of dependent bean is bound to the bean injecting it - it will be created and destroyed along with the bean injecting it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@javax.enterprise.context.SessionScoped</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This scope is backed by a <code>javax.servlet.http.HttpSession</code> object. It&#8217;s only available if the <code>quarkus-undertow</code> extension is used.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There can be other custom scopes provided by Quarkus extensions. For example, <code>quarkus-narayana-jta</code> provides <code>javax.transaction.TransactionScoped</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="applicationscoped-and-singleton-look-very-similar-which-one-should-i-choose-for-my-quarkus-application"><a class="anchor" href="#applicationscoped-and-singleton-look-very-similar-which-one-should-i-choose-for-my-quarkus-application"></a>11. <code>@ApplicationScoped</code> and <code>@Singleton</code> look very similar. Which one should I choose for my Quarkus application?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It depends ;-).</p>
</div>
<div class="paragraph">
<p>A <code>@Singleton</code> bean has no <a href="#client_proxies">client proxy</a> and hence an instance is <em>created eagerly</em> when the bean is injected. By contrast, an instance of an <code>@ApplicationScoped</code> bean is <em>created lazily</em>, i.e.
when a method is invoked upon an injected instance for the first time.</p>
</div>
<div class="paragraph">
<p>Furthermore, client proxies only delegate method invocations and thus you should never read/write fields of an injected <code>@ApplicationScoped</code> bean directly.
You can read/write fields of an injected <code>@Singleton</code> safely.</p>
</div>
<div class="paragraph">
<p><code>@Singleton</code> should have a slightly better performance because the is no indirection (no proxy that delegates to the current instance from the context).</p>
</div>
<div class="paragraph">
<p>On the other hand, you cannot mock <code>@Singleton</code> beans using <a href="getting-started-testing.html#quarkus_mock">QuarkusMock</a>.</p>
</div>
<div class="paragraph">
<p><code>@ApplicationScoped</code> beans can be also destroyed and recreated at runtime.
Existing injection points just work because the injected proxy delegates to the current instance.</p>
</div>
<div class="paragraph">
<p>Therefore, we recommend to stick with <code>@ApplicationScoped</code> by default unless there&#8217;s a good reason to use <code>@Singleton</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client_proxies"><a class="anchor" href="#client_proxies"></a>12. I don&#8217;t understand the concept of client proxies.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Indeed, the <a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html#client_proxies" target="_blank" rel="noopener">client proxies</a> could be hard to grasp but they provide some useful functionality.
A client proxy is basically an object that delegates all method invocations to a target bean instance.
It&#8217;s a container construct that implements <code>io.quarkus.arc.ClientProxy</code> and extends the bean class.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Client proxies only delegate method invocations. So never read or write a field of a normal scoped bean, otherwise you will work with non-contextual or stale data.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Generated Client Proxy Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
class Translator {

    String translate(String sentence) {
      // ...
    }
}

// The client proxy class is generated and looks like...
class Translator_ClientProxy extends Translator { <i class="conum" data-value="1"></i><b>(1)</b>

    String translate(String sentence) {
      // Find the correct translator instance...
      Translator translator = getTranslatorInstanceFromTheApplicationContext();
      // And delegate the method invocation...
      return translator.translate(sentence);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Translator_ClientProxy</code> instance is always injected instead of a direct reference to a <a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html#contextual_instance" target="_blank" rel="noopener">contextual instance</a> of the <code>Translator</code> bean.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Client proxies allow for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lazy instantiation - the instance is created once a method is invoked upon the proxy.</p>
</li>
<li>
<p>Ability to inject a bean with "narrower" scope to a bean with "wider" scope; i.e. you can inject a <code>@RequestScoped</code> bean into an <code>@ApplicationScoped</code> bean.</p>
</li>
<li>
<p>Circular dependencies in the dependency graph. Having circular dependencies is often an indication that a redesign should be considered, but sometimes it&#8217;s inevitable.</p>
</li>
<li>
<p>In rare cases it&#8217;s practical to destroy the beans manually. A direct injected reference would lead to a stale bean instance.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ok-you-said-that-there-are-several-kinds-of-beans"><a class="anchor" href="#ok-you-said-that-there-are-several-kinds-of-beans"></a>13. OK. You said that there are several kinds of beans?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Yes. In general, we distinguish:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Class beans</p>
</li>
<li>
<p>Producer methods</p>
</li>
<li>
<p>Producer fields</p>
</li>
<li>
<p>Synthetic beans</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Synthetic beans are usually provided by extensions. Therefore, we are not going to cover them in this guide.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Producer methods and fields are useful if you need additional control over instantiation of a bean.
They are also useful when integrating third-party libraries where you don&#8217;t control the class source and may not add additional annotations etc.</p>
</div>
<div class="listingblock">
<div class="title">Producers Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class Producers {

    @Produces <i class="conum" data-value="1"></i><b>(1)</b>
    double pi = Math.PI; <i class="conum" data-value="2"></i><b>(2)</b>

    @Produces <i class="conum" data-value="3"></i><b>(3)</b>
    List&lt;String&gt; names() {
       List&lt;String&gt; names = new ArrayList&lt;&gt;();
       names.add("Andy");
       names.add("Adalbert");
       names.add("Joachim");
       return names; <i class="conum" data-value="4"></i><b>(4)</b>
    }
}

@ApplicationScoped
public class Consumer {

   @Inject
   double pi;

   @Inject
   List&lt;String&gt; names;

   // ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The container analyses the field annotations to build a bean metadata.
The <em>type</em> is used to build the set of bean types.
In this case, it will be <code>double</code> and <code>java.lang.Object</code>.
No scope annotation is declared and so it&#8217;s defaulted to <code>@Dependent</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The container will read this field when creating the bean instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The container analyses the method annotations to build a bean metadata.
The <em>return type</em> is used to build the set of bean types.
In this case, it will be <code>List&lt;String&gt;</code>, <code>Collection&lt;String&gt;</code>, <code>Iterable&lt;String&gt;</code> and <code>java.lang.Object</code>.
No scope annotation is declared and so it&#8217;s defaulted to <code>@Dependent</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The container will call this method when creating the bean instance.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There&#8217;s more about producers.
You can declare qualifiers, inject dependencies into the producer methods parameters, etc.
You can read more about producers for example in the <a href="https://docs.jboss.org/weld/reference/latest/en-US/html/producermethods.html" target="_blank" rel="noopener">Weld docs</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ok-injection-looks-cool-what-other-services-are-provided"><a class="anchor" href="#ok-injection-looks-cool-what-other-services-are-provided"></a>14. OK, injection looks cool. What other services are provided?</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="lifecycle-callbacks"><a class="anchor" href="#lifecycle-callbacks"></a>14.1. Lifecycle Callbacks</h3>
<div class="paragraph">
<p>A bean class may declare lifecycle <code>@PostConstruct</code> and <code>@PreDestroy</code> callbacks:</p>
</div>
<div class="listingblock">
<div class="title">Lifecycle Callbacks Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;

@ApplicationScoped
public class Translator {

    @PostConstruct <i class="conum" data-value="1"></i><b>(1)</b>
    void init() {
       // ...
    }

    @PreDestroy <i class="conum" data-value="2"></i><b>(2)</b>
    void destroy() {
      // ...
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This callback is invoked before the bean instance is put into service. It is safe to perform some initialization here.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This callback is invoked before the bean instance is destroyed. It is safe to perform some cleanup tasks here.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It&#8217;s a good practice to keep the logic in the callbacks "without side effects", i.e. you should avoid calling other beans inside the callbacks.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="interceptors"><a class="anchor" href="#interceptors"></a>14.2. Interceptors</h3>
<div class="paragraph">
<p>Interceptors are used to separate cross-cutting concerns from business logic.
There is a separate specification - Java Interceptors - that defines the basic programming model and semantics.</p>
</div>
<div class="listingblock">
<div class="title">Simple Interceptor Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import javax.interceptor.Interceptor;
import javax.annotation.Priority;

@Logged <i class="conum" data-value="1"></i><b>(1)</b>
@Priority(2020) <i class="conum" data-value="2"></i><b>(2)</b>
@Interceptor <i class="conum" data-value="3"></i><b>(3)</b>
public class LoggingInterceptor {

   @Inject <i class="conum" data-value="4"></i><b>(4)</b>
   Logger logger;

   @AroundInvoke <i class="conum" data-value="5"></i><b>(5)</b>
   Object logInvocation(InvocationContext context) {
      // ...log before
      Object ret = context.proceed(); <i class="conum" data-value="6"></i><b>(6)</b>
      // ...log after
      return ret;
   }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This is an interceptor binding annotation that is used to bind our interceptor to a bean. Simply annotate a bean class with <code>@Logged</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>Priority</code> enables the interceptor and affects the interceptor ordering. Interceptors with smaller priority values are called first.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Marks an interceptor component.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>An interceptor instance may be the target of dependency injection.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>AroundInvoke</code> denotes a method that interposes on business methods.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Proceed to the next interceptor in the interceptor chain or invoke the intercepted business method.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Instances of interceptors are dependent objects of the bean instance they intercept, i.e. a new interceptor instance is created for each intercepted bean.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="decorators"><a class="anchor" href="#decorators"></a>14.3. Decorators</h3>
<div class="paragraph">
<p>Decorators are similar to interceptors, but because they implement interfaces with business semantics, they are able to implement business logic.</p>
</div>
<div class="listingblock">
<div class="title">Simple Decorator Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import javax.decorator.Decorator;
import javax.decorator.Delegate;
import javax.annotation.Priority;
import javax.inject.Inject;
import javax.enterprise.inject.Any;

public interface Account {
   void withdraw(BigDecimal amount);
}

@Priority(10) <i class="conum" data-value="1"></i><b>(1)</b>
@Decorator <i class="conum" data-value="2"></i><b>(2)</b>
public class LargeTxAccount implements Account { <i class="conum" data-value="3"></i><b>(3)</b>

   @Inject
   @Any
   @Delegate
   Account delegate; <i class="conum" data-value="4"></i><b>(4)</b>

   @Inject
   LogService logService; <i class="conum" data-value="5"></i><b>(5)</b>

   void withdraw(BigDecimal amount) {
      delegate.withdraw(amount); <i class="conum" data-value="6"></i><b>(6)</b>
      if (amount.compareTo(1000) &gt; 0) {
         logService.logWithdrawal(delegate, amount);
      }
   }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Priority</code> enables the decorator. Decorators with smaller priority values are called first.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>@Decorator</code> marks a decorator component.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The set of decorated types includes all bean types which are Java interfaces, except for <code>java.io.Serializable</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Each decorator must declare exactly one <em>delegate injection point</em>. The decorator applies to beans that are assignable to this delegate injection point.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Decorators can inject other beans.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The decorator may invoke any method of the delegate object. And the container invokes either the next decorator in the chain or the business method of the intercepted instance.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Instances of decorators are dependent objects of the bean instance they intercept, i.e. a new decorator instance is created for each intercepted bean.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="events-and-observers"><a class="anchor" href="#events-and-observers"></a>14.4. Events and Observers</h3>
<div class="paragraph">
<p>Beans may also produce and consume events to interact in a completely decoupled fashion.
Any Java object can serve as an event payload.
The optional qualifiers act as topic selectors.</p>
</div>
<div class="listingblock">
<div class="title">Simple Event Example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">class TaskCompleted {
  // ...
}

@ApplicationScoped
class ComplicatedService {

   @Inject
   Event&lt;TaskCompleted&gt; event; <i class="conum" data-value="1"></i><b>(1)</b>

   void doSomething() {
      // ...
      event.fire(new TaskCompleted()); <i class="conum" data-value="2"></i><b>(2)</b>
   }

}

@ApplicationScoped
class Logger {

   void onTaskCompleted(@Observes TaskCompleted task) { <i class="conum" data-value="3"></i><b>(3)</b>
      // ...log the task
   }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>javax.enterprise.event.Event</code> is used to fire events.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Fire the event synchronously.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This method is notified when a <code>TaskCompleted</code> event is fired.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For more info about events/observers visit <a href="https://docs.jboss.org/weld/reference/latest/en-US/html/events.html" target="_blank" rel="noopener">Weld docs</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion"><a class="anchor" href="#conclusion"></a>15. Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, we&#8217;ve covered some of the basic topics of the Quarkus programming model that is based on the <a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html" target="_blank" rel="noopener">Contexts and Dependency Injection for Java 2.0</a> specification.
However, a full CDI implementation is not used under the hood.
Quarkus only implements a subset of the CDI features - see also <a href="cdi-reference.html#supported_features">the list of supported features</a> and <a href="cdi-reference.html#limitations">the list of limitations</a>.
On the other hand, there are quite a few <a href="cdi-reference.html#nonstandard_features">non-standard features</a> and <a href="cdi-reference.html#build_time_apis">Quarkus-specific APIs</a>.
We believe that our efforts will drive the innovation of the CDI specification towards the build-time oriented developer stacks in the future.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you wish to learn more about Quarkus-specific features and limitations there is a Quarkus <a href="cdi-reference.html">CDI Reference Guide</a>.
We also recommend you to read the <a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html">CDI specification</a> and the <a href="https://docs.jboss.org/weld/reference/latest/en-US/html/">Weld documentation</a> (Weld is a CDI Reference Implementation) to get acquainted with more complex topics.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-17 11:27:40 +0800
</div>
</div>
</body>
</html>